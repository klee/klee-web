---
version: 2.1

orbs: 
  ansible: trustedshops-public/ansible@2.0.0

jobs:
  build:
    machine:
      image: cimg/base
    steps:
      # ---- Provisioning ----
      - checkout
      - run: sudo ln -s /home/circleci/project/ /kleeweb_src
      - ansible/install-ansible
      - ansible/install-roles
      - run: cd /kleeweb_src/
      - ansible/run-playbook:
          inventory: "./provisioning/hosts-ci"
          playbook: "--syntax-check ./provisioning/deploy.yml"
      - ansible/run-playbook:
          inventory: "./provisioning/hosts-ci"
          playbook: "-vvv ./provisioning/deploy.yml"
